@startuml MGX_MVP_UI_Navigation

[*] --> Home : User visits platform

state "Home Page" as Home {
    [*] --> Landing
    Landing : - Hero section
    Landing : - Feature highlights
    Landing : - Quick start CTA
}

state "Authentication" as Auth {
    [*] --> Login
    Login : - Email/password
    Login : - OAuth options
    Login --> Register : Sign up link
    Register --> Login : Back to login
}

state "Dashboard" as Dashboard {
    [*] --> Overview
    Overview : - Recent sessions
    Overview : - Quick actions
    Overview : - Usage stats
}

state "Chat Workspace" as ChatWorkspace {
    [*] --> WorkspaceView
    WorkspaceView : - Chat Interface (30%)
    WorkspaceView : - Code Editor + Preview (70%)
    
    state "Chat Interface (整合版)" as ChatInterface {
        [*] --> ChatView
        ChatView : - Message history
        ChatView : - Agent status indicators
        ChatView : - Task progress display
        ChatView : - Input box
        ChatView : - File attachments
        ChatView : - Collapsible sidebar
        
        note right of ChatView
            整合功能:
            1. 对话消息流
            2. Agent工作状态
            3. 任务进度条
            4. 工作流可视化
            5. 支持折叠
        end note
    }
    
    state "Editor & Preview Area" as EditorPreview {
        [*] --> SplitView
        SplitView : - Code Editor (Monaco)
        SplitView : - File Tree
        SplitView : - Terminal
        SplitView : - Live Preview
        SplitView : - Responsive views
        
        state "Code Editor" as CodeEditor {
            [*] --> EditorView
            EditorView : - Syntax highlighting
            EditorView : - File tabs
            EditorView : - Auto-completion
        }
        
        state "Preview Panel" as PreviewPanel {
            [*] --> PreviewMode
            PreviewMode : - Live preview
            PreviewMode : - Device selector
            PreviewMode : - Console logs
        }
    }
    
    WorkspaceView --> ChatInterface : View chat
    WorkspaceView --> EditorPreview : Edit/Preview
}

state "Preview & Deploy" as Preview {
    [*] --> PreviewMode
    PreviewMode : - Full screen preview
    PreviewMode : - Responsive views
    PreviewMode : - Console logs
    
    PreviewMode --> DeployOptions : Deploy button
    
    state "Deploy Options" as DeployOptions {
        [*] --> PlatformSelect
        PlatformSelect : - Vercel
        PlatformSelect : - Netlify
        PlatformSelect : - GitHub Pages
    }
}

state "Projects" as Projects {
    [*] --> ProjectList
    ProjectList : - All projects
    ProjectList : - Search/filter
    ProjectList --> ProjectDetail : Select project
    
    state "Project Detail" as ProjectDetail {
        [*] --> ProjectInfo
        ProjectInfo : - Project metadata
        ProjectInfo : - Sessions
        ProjectInfo : - Deployments
    }
}

state "Settings" as Settings {
    [*] --> UserSettings
    UserSettings : - Profile
    UserSettings : - API keys
    UserSettings : - Preferences
    UserSettings : - Billing
}

' Main navigation flow
Home --> Auth : Sign in/up
Auth --> Dashboard : Authenticated

Dashboard --> ChatWorkspace : New session
Dashboard --> Projects : View projects
Dashboard --> Settings : Settings icon

ChatWorkspace --> Preview : Full screen preview
ChatWorkspace --> Dashboard : Home button
ChatWorkspace --> Projects : Save project
ChatWorkspace --> Settings : Settings icon

Preview --> ChatWorkspace : Back to workspace

Projects --> ChatWorkspace : Open session
Projects --> Dashboard : Back
Projects --> Settings : Settings icon

Settings --> Dashboard : Back
Settings --> ChatWorkspace : Back to session
Settings --> Projects : Back to projects

' Quick actions from any state
ChatWorkspace --> [*] : Logout
Dashboard --> [*] : Logout
Projects --> [*] : Logout
Settings --> [*] : Logout

note right of ChatWorkspace
    主工作区布局:
    [ChatUI 30%] [Editor+Preview 70%]
    
    ChatUI可折叠以最大化编辑预览空间
    Max depth: 2 levels
    Always accessible back button
end note

note right of ChatInterface
    整合TaskDashboard功能:
    - Agent状态嵌入消息卡片
    - 进度条显示在Agent消息内
    - 任务列表可折叠展开
    - 支持流式输出
end note

note right of Preview
    Quick access to deploy
    No more than 2 clicks from workspace
end note

@enduml